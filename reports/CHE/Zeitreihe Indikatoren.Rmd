---
title: "Indikatoren"
author: "Branco & Zadeyan"
date: "03 JÃ¤nner 2019"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Ungleichheitsindikatoren nach P1, include=FALSE}


#Definition Jahr; 
year <- 2008

#Erstellung des Survey Designs (in Zeile data=(silc.dprh %>% filter(pb010=XX) XX Für bestimmtes Jahr eintragen)
silc.dprh.svy <- svydesign(ids=~id_h,
                       strata=~db040,
                       weights=~db090,
                       data=(silc.dprh %>% filter(pb010==year))) %>% convey_prep()

# Mittelwert von Factor, National und Post Tax Disposable Income 
MeanIncomeP1 <- c(
  svymean(~factorincomep1,silc.dprh.svy),
  svymean(~nationalincomep1,silc.dprh.svy),
  svymean(~postaxincomep1,silc.dprh.svy))

# Median von Factor, National und Post Tax Disposable Income
MedianIncomeP1 <- c(
  svyquantile(~factorincomep1,silc.dprh.svy,quantile=c(0.5)),
  svyquantile(~nationalincomep1,silc.dprh.svy,quantile=c(0.5)),
  svyquantile(~postaxincomep1,silc.dprh.svy,quantile=c(0.5)))

# Gini von Factor, Natonal und Post Tax Disposable Income
GiniP1 <- c(
  svygini(~factorincomep1, silc.dprh.svy),
  svygini(~nationalincomep1, silc.dprh.svy),
  svygini(~postaxincomep1, silc.dprh.svy))

# P80/P20 von Factor, National und Post Tax Disposable Income
P8020P1 <- c(
  svyqsr(~factorincomep1,silc.dprh.svy),
  svyqsr(~nationalincomep1,silc.dprh.svy),
  svyqsr(~postaxincomep1,silc.dprh.svy))

# Top 10% Anteil von Factor, National und Post Tax Disposable Income

Top10ShareP1 <- c(
svytotal(~factorincomep1,subset(silc.dprh.svy, factorincomep1>=as.numeric(svyquantile(~factorincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~factorincomep1,silc.dprh.svy),
svytotal(~nationalincomep1,subset(silc.dprh.svy, nationalincomep1>=as.numeric(svyquantile(~nationalincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~nationalincomep1,silc.dprh.svy),
svytotal(~postaxincomep1,subset(silc.dprh.svy, postaxincomep1>=as.numeric(svyquantile(~postaxincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~postaxincomep1,silc.dprh.svy))

#Erstellung Tabelle
T2008P1 <- data.frame(MeanIncomeP1, MedianIncomeP1, GiniP1, P8020P1, Top10ShareP1)
colnames(T2008P1)<- c("Mean 2008", "Median 2008", "Gini 2008", "P80/20 2008", "Top 10% Share 2008")
```


```{r Ungleichheitsindikatoren nach P2, include=FALSE}
#Definition Jahr; 
year <- 2008

#Filtern >=20
silc.dprhp2 <- silc.dprh %>% filter(age >= 20)

#Erstellung des Survey Designs (in Zeile data=(silc.dprhp2 %>% filter(pb010=XX) XX Für bestimmtes Jahr eintragen)
silc.dprhp2.svy <- svydesign(ids=~id_h,
                       strata=~db040,
                       weights=~db090,
                       data=(silc.dprhp2 %>% filter(pb010==year))) %>% convey_prep()
# Mittelwert von Factor, National und Post Tax Disposable Income 
MeanIncomeP2 <- c(
  svymean(~factorincomep2,silc.dprhp2.svy),
  svymean(~nationalincomep2,silc.dprhp2.svy),
  svymean(~postaxincomep2,silc.dprhp2.svy))

# Median von Factor, National und Post Tax Disposable Income
MedianIncomeP2 <- c(
  svyquantile(~factorincomep2,silc.dprhp2.svy,quantile=c(0.5)),
  svyquantile(~nationalincomep2,silc.dprhp2.svy,quantile=c(0.5)),
  svyquantile(~postaxincomep2,silc.dprhp2.svy,quantile=c(0.5)))

# Gini von Factor, Natonal und Post Tax Disposable Income
GiniP2 <- c(
  svygini(~factorincomep2, silc.dprhp2.svy),
  svygini(~nationalincomep2, silc.dprhp2.svy),
  svygini(~postaxincomep2, silc.dprhp2.svy))

# P80/P20 von Factor, National und Post Tax Disposable Income
P8020P2 <- c(
  svyqsr(~factorincomep2,silc.dprhp2.svy),
  svyqsr(~nationalincomep2,silc.dprhp2.svy),
  svyqsr(~postaxincomep2,silc.dprhp2.svy))

# Top 10% Anteil von Factor, National und Post Tax Disposable Income

Top10ShareP2 <- c(
svytotal(~factorincomep2,subset(silc.dprhp2.svy, factorincomep2>=as.numeric(svyquantile(~factorincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~factorincomep2,silc.dprhp2.svy),
svytotal(~nationalincomep2,subset(silc.dprhp2.svy, nationalincomep2>=as.numeric(svyquantile(~nationalincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~nationalincomep2,silc.dprhp2.svy),
svytotal(~postaxincomep2,subset(silc.dprhp2.svy, postaxincomep2>=as.numeric(svyquantile(~postaxincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~postaxincomep2,silc.dprhp2.svy))

#Erstellung Tabelle
T2008P2 <- data.frame(MeanIncomeP2, MedianIncomeP2, GiniP2, P8020P2, Top10ShareP2)
colnames(T2008P2)<- c("Mean 2008", "Median 2008", "Gini 2008", "P80/20 2008", "Top 10% Share 2008")
```

```{r Ungleichheitsindikatoren nach P1, include=FALSE}


#Definition Jahr; 
year <- 2009

#Erstellung des Survey Designs (in Zeile data=(silc.dprh %>% filter(pb010=XX) XX Für bestimmtes Jahr eintragen)
silc.dprh.svy <- svydesign(ids=~id_h,
                       strata=~db040,
                       weights=~db090,
                       data=(silc.dprh %>% filter(pb010==year))) %>% convey_prep()

# Mittelwert von Factor, National und Post Tax Disposable Income 
MeanIncomeP1 <- c(
  svymean(~factorincomep1,silc.dprh.svy),
  svymean(~nationalincomep1,silc.dprh.svy),
  svymean(~postaxincomep1,silc.dprh.svy))

# Median von Factor, National und Post Tax Disposable Income
MedianIncomeP1 <- c(
  svyquantile(~factorincomep1,silc.dprh.svy,quantile=c(0.5)),
  svyquantile(~nationalincomep1,silc.dprh.svy,quantile=c(0.5)),
  svyquantile(~postaxincomep1,silc.dprh.svy,quantile=c(0.5)))

# Gini von Factor, Natonal und Post Tax Disposable Income
GiniP1 <- c(
  svygini(~factorincomep1, silc.dprh.svy),
  svygini(~nationalincomep1, silc.dprh.svy),
  svygini(~postaxincomep1, silc.dprh.svy))

# P80/P20 von Factor, National und Post Tax Disposable Income
P8020P1 <- c(
  svyqsr(~factorincomep1,silc.dprh.svy),
  svyqsr(~nationalincomep1,silc.dprh.svy),
  svyqsr(~postaxincomep1,silc.dprh.svy))

# Top 10% Anteil von Factor, National und Post Tax Disposable Income

Top10ShareP1 <- c(
svytotal(~factorincomep1,subset(silc.dprh.svy, factorincomep1>=as.numeric(svyquantile(~factorincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~factorincomep1,silc.dprh.svy),
svytotal(~nationalincomep1,subset(silc.dprh.svy, nationalincomep1>=as.numeric(svyquantile(~nationalincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~nationalincomep1,silc.dprh.svy),
svytotal(~postaxincomep1,subset(silc.dprh.svy, postaxincomep1>=as.numeric(svyquantile(~postaxincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~postaxincomep1,silc.dprh.svy))

#Erstellung Tabelle
T2009P1 <- data.frame(MeanIncomeP1, MedianIncomeP1, GiniP1, P8020P1, Top10ShareP1)
colnames(T2009P1)<- c("Mean 2009", "Median 2009", "Gini 2009", "P80/20 2009", "Top 10% Share 2009")
```


```{r Ungleichheitsindikatoren nach P2, include=FALSE}
#Definition Jahr; 
year <- 2009

#Filtern >=20
silc.dprhp2 <- silc.dprh %>% filter(age >= 20)

#Erstellung des Survey Designs (in Zeile data=(silc.dprhp2 %>% filter(pb010=XX) XX Für bestimmtes Jahr eintragen)
silc.dprhp2.svy <- svydesign(ids=~id_h,
                       strata=~db040,
                       weights=~db090,
                       data=(silc.dprhp2 %>% filter(pb010==year))) %>% convey_prep()
# Mittelwert von Factor, National und Post Tax Disposable Income 
MeanIncomeP2 <- c(
  svymean(~factorincomep2,silc.dprhp2.svy),
  svymean(~nationalincomep2,silc.dprhp2.svy),
  svymean(~postaxincomep2,silc.dprhp2.svy))

# Median von Factor, National und Post Tax Disposable Income
MedianIncomeP2 <- c(
  svyquantile(~factorincomep2,silc.dprhp2.svy,quantile=c(0.5)),
  svyquantile(~nationalincomep2,silc.dprhp2.svy,quantile=c(0.5)),
  svyquantile(~postaxincomep2,silc.dprhp2.svy,quantile=c(0.5)))

# Gini von Factor, Natonal und Post Tax Disposable Income
GiniP2 <- c(
  svygini(~factorincomep2, silc.dprhp2.svy),
  svygini(~nationalincomep2, silc.dprhp2.svy),
  svygini(~postaxincomep2, silc.dprhp2.svy))

# P80/P20 von Factor, National und Post Tax Disposable Income
P8020P2 <- c(
  svyqsr(~factorincomep2,silc.dprhp2.svy),
  svyqsr(~nationalincomep2,silc.dprhp2.svy),
  svyqsr(~postaxincomep2,silc.dprhp2.svy))

# Top 10% Anteil von Factor, National und Post Tax Disposable Income

Top10ShareP2 <- c(
svytotal(~factorincomep2,subset(silc.dprhp2.svy, factorincomep2>=as.numeric(svyquantile(~factorincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~factorincomep2,silc.dprhp2.svy),
svytotal(~nationalincomep2,subset(silc.dprhp2.svy, nationalincomep2>=as.numeric(svyquantile(~nationalincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~nationalincomep2,silc.dprhp2.svy),
svytotal(~postaxincomep2,subset(silc.dprhp2.svy, postaxincomep2>=as.numeric(svyquantile(~postaxincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~postaxincomep2,silc.dprhp2.svy))

#Erstellung Tabelle
T2009P2 <- data.frame(MeanIncomeP2, MedianIncomeP2, GiniP2, P8020P2, Top10ShareP2)
colnames(T2009P2)<- c("Mean 2009", "Median 2009", "Gini 2009", "P80/20 2009", "Top 10% Share 2009")
```

```{r Ungleichheitsindikatoren nach P1, include=FALSE}


#Definition Jahr; 
year <- 2010

#Erstellung des Survey Designs (in Zeile data=(silc.dprh %>% filter(pb010=XX) XX Für bestimmtes Jahr eintragen)
silc.dprh.svy <- svydesign(ids=~id_h,
                       strata=~db040,
                       weights=~db090,
                       data=(silc.dprh %>% filter(pb010==year))) %>% convey_prep()

# Mittelwert von Factor, National und Post Tax Disposable Income 
MeanIncomeP1 <- c(
  svymean(~factorincomep1,silc.dprh.svy),
  svymean(~nationalincomep1,silc.dprh.svy),
  svymean(~postaxincomep1,silc.dprh.svy))

# Median von Factor, National und Post Tax Disposable Income
MedianIncomeP1 <- c(
  svyquantile(~factorincomep1,silc.dprh.svy,quantile=c(0.5)),
  svyquantile(~nationalincomep1,silc.dprh.svy,quantile=c(0.5)),
  svyquantile(~postaxincomep1,silc.dprh.svy,quantile=c(0.5)))

# Gini von Factor, Natonal und Post Tax Disposable Income
GiniP1 <- c(
  svygini(~factorincomep1, silc.dprh.svy),
  svygini(~nationalincomep1, silc.dprh.svy),
  svygini(~postaxincomep1, silc.dprh.svy))

# P80/P20 von Factor, National und Post Tax Disposable Income
P8020P1 <- c(
  svyqsr(~factorincomep1,silc.dprh.svy),
  svyqsr(~nationalincomep1,silc.dprh.svy),
  svyqsr(~postaxincomep1,silc.dprh.svy))

# Top 10% Anteil von Factor, National und Post Tax Disposable Income

Top10ShareP1 <- c(
svytotal(~factorincomep1,subset(silc.dprh.svy, factorincomep1>=as.numeric(svyquantile(~factorincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~factorincomep1,silc.dprh.svy),
svytotal(~nationalincomep1,subset(silc.dprh.svy, nationalincomep1>=as.numeric(svyquantile(~nationalincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~nationalincomep1,silc.dprh.svy),
svytotal(~postaxincomep1,subset(silc.dprh.svy, postaxincomep1>=as.numeric(svyquantile(~postaxincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~postaxincomep1,silc.dprh.svy))

#Erstellung Tabelle
T2010P1 <- data.frame(MeanIncomeP1, MedianIncomeP1, GiniP1, P8020P1, Top10ShareP1)
colnames(T2010P1)<- c("Mean 2010", "Median 2010", "Gini 2010", "P80/20 2010", "Top 10% Share 2010")
```


```{r Ungleichheitsindikatoren nach P2, include=FALSE}
#Definition Jahr; 
year <- 2010

#Filtern >=20
silc.dprhp2 <- silc.dprh %>% filter(age >= 20)

#Erstellung des Survey Designs (in Zeile data=(silc.dprhp2 %>% filter(pb010=XX) XX Für bestimmtes Jahr eintragen)
silc.dprhp2.svy <- svydesign(ids=~id_h,
                       strata=~db040,
                       weights=~db090,
                       data=(silc.dprhp2 %>% filter(pb010==year))) %>% convey_prep()
# Mittelwert von Factor, National und Post Tax Disposable Income 
MeanIncomeP2 <- c(
  svymean(~factorincomep2,silc.dprhp2.svy),
  svymean(~nationalincomep2,silc.dprhp2.svy),
  svymean(~postaxincomep2,silc.dprhp2.svy))

# Median von Factor, National und Post Tax Disposable Income
MedianIncomeP2 <- c(
  svyquantile(~factorincomep2,silc.dprhp2.svy,quantile=c(0.5)),
  svyquantile(~nationalincomep2,silc.dprhp2.svy,quantile=c(0.5)),
  svyquantile(~postaxincomep2,silc.dprhp2.svy,quantile=c(0.5)))

# Gini von Factor, Natonal und Post Tax Disposable Income
GiniP2 <- c(
  svygini(~factorincomep2, silc.dprhp2.svy),
  svygini(~nationalincomep2, silc.dprhp2.svy),
  svygini(~postaxincomep2, silc.dprhp2.svy))

# P80/P20 von Factor, National und Post Tax Disposable Income
P8020P2 <- c(
  svyqsr(~factorincomep2,silc.dprhp2.svy),
  svyqsr(~nationalincomep2,silc.dprhp2.svy),
  svyqsr(~postaxincomep2,silc.dprhp2.svy))

# Top 10% Anteil von Factor, National und Post Tax Disposable Income

Top10ShareP2 <- c(
svytotal(~factorincomep2,subset(silc.dprhp2.svy, factorincomep2>=as.numeric(svyquantile(~factorincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~factorincomep2,silc.dprhp2.svy),
svytotal(~nationalincomep2,subset(silc.dprhp2.svy, nationalincomep2>=as.numeric(svyquantile(~nationalincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~nationalincomep2,silc.dprhp2.svy),
svytotal(~postaxincomep2,subset(silc.dprhp2.svy, postaxincomep2>=as.numeric(svyquantile(~postaxincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~postaxincomep2,silc.dprhp2.svy))

#Erstellung Tabelle
T2010P2 <- data.frame(MeanIncomeP2, MedianIncomeP2, GiniP2, P8020P2, Top10ShareP2)
colnames(T2010P2)<- c("Mean 2010", "Median 2010", "Gini 2010", "P80/20 2010", "Top 10% Share 2010")
```


```{r Ungleichheitsindikatoren nach P1, include=FALSE}


#Definition Jahr; 
year <- 2011

#Erstellung des Survey Designs (in Zeile data=(silc.dprh %>% filter(pb010=XX) XX Für bestimmtes Jahr eintragen)
silc.dprh.svy <- svydesign(ids=~id_h,
                       strata=~db040,
                       weights=~db090,
                       data=(silc.dprh %>% filter(pb010==year))) %>% convey_prep()

# Mittelwert von Factor, National und Post Tax Disposable Income 
MeanIncomeP1 <- c(
  svymean(~factorincomep1,silc.dprh.svy),
  svymean(~nationalincomep1,silc.dprh.svy),
  svymean(~postaxincomep1,silc.dprh.svy))

# Median von Factor, National und Post Tax Disposable Income
MedianIncomeP1 <- c(
  svyquantile(~factorincomep1,silc.dprh.svy,quantile=c(0.5)),
  svyquantile(~nationalincomep1,silc.dprh.svy,quantile=c(0.5)),
  svyquantile(~postaxincomep1,silc.dprh.svy,quantile=c(0.5)))

# Gini von Factor, Natonal und Post Tax Disposable Income
GiniP1 <- c(
  svygini(~factorincomep1, silc.dprh.svy),
  svygini(~nationalincomep1, silc.dprh.svy),
  svygini(~postaxincomep1, silc.dprh.svy))

# P80/P20 von Factor, National und Post Tax Disposable Income
P8020P1 <- c(
  svyqsr(~factorincomep1,silc.dprh.svy),
  svyqsr(~nationalincomep1,silc.dprh.svy),
  svyqsr(~postaxincomep1,silc.dprh.svy))

# Top 10% Anteil von Factor, National und Post Tax Disposable Income

Top10ShareP1 <- c(
svytotal(~factorincomep1,subset(silc.dprh.svy, factorincomep1>=as.numeric(svyquantile(~factorincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~factorincomep1,silc.dprh.svy),
svytotal(~nationalincomep1,subset(silc.dprh.svy, nationalincomep1>=as.numeric(svyquantile(~nationalincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~nationalincomep1,silc.dprh.svy),
svytotal(~postaxincomep1,subset(silc.dprh.svy, postaxincomep1>=as.numeric(svyquantile(~postaxincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~postaxincomep1,silc.dprh.svy))

#Erstellung Tabelle
T2011P1 <- data.frame(MeanIncomeP1, MedianIncomeP1, GiniP1, P8020P1, Top10ShareP1)
colnames(T2011P1)<- c("Mean 2011", "Median 2011", "Gini 2011", "P80/20 2011", "Top 10% Share 2011")
```


```{r Ungleichheitsindikatoren nach P2, include=FALSE}
#Definition Jahr; 
year <- 2011

#Filtern >=20
silc.dprhp2 <- silc.dprh %>% filter(age >= 20)

#Erstellung des Survey Designs (in Zeile data=(silc.dprhp2 %>% filter(pb010=XX) XX Für bestimmtes Jahr eintragen)
silc.dprhp2.svy <- svydesign(ids=~id_h,
                       strata=~db040,
                       weights=~db090,
                       data=(silc.dprhp2 %>% filter(pb010==year))) %>% convey_prep()
# Mittelwert von Factor, National und Post Tax Disposable Income 
MeanIncomeP2 <- c(
  svymean(~factorincomep2,silc.dprhp2.svy),
  svymean(~nationalincomep2,silc.dprhp2.svy),
  svymean(~postaxincomep2,silc.dprhp2.svy))

# Median von Factor, National und Post Tax Disposable Income
MedianIncomeP2 <- c(
  svyquantile(~factorincomep2,silc.dprhp2.svy,quantile=c(0.5)),
  svyquantile(~nationalincomep2,silc.dprhp2.svy,quantile=c(0.5)),
  svyquantile(~postaxincomep2,silc.dprhp2.svy,quantile=c(0.5)))

# Gini von Factor, Natonal und Post Tax Disposable Income
GiniP2 <- c(
  svygini(~factorincomep2, silc.dprhp2.svy),
  svygini(~nationalincomep2, silc.dprhp2.svy),
  svygini(~postaxincomep2, silc.dprhp2.svy))

# P80/P20 von Factor, National und Post Tax Disposable Income
P8020P2 <- c(
  svyqsr(~factorincomep2,silc.dprhp2.svy),
  svyqsr(~nationalincomep2,silc.dprhp2.svy),
  svyqsr(~postaxincomep2,silc.dprhp2.svy))

# Top 10% Anteil von Factor, National und Post Tax Disposable Income

Top10ShareP2 <- c(
svytotal(~factorincomep2,subset(silc.dprhp2.svy, factorincomep2>=as.numeric(svyquantile(~factorincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~factorincomep2,silc.dprhp2.svy),
svytotal(~nationalincomep2,subset(silc.dprhp2.svy, nationalincomep2>=as.numeric(svyquantile(~nationalincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~nationalincomep2,silc.dprhp2.svy),
svytotal(~postaxincomep2,subset(silc.dprhp2.svy, postaxincomep2>=as.numeric(svyquantile(~postaxincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~postaxincomep2,silc.dprhp2.svy))

#Erstellung Tabelle
T2011P2 <- data.frame(MeanIncomeP2, MedianIncomeP2, GiniP2, P8020P2, Top10ShareP2)
colnames(T2011P2)<- c("Mean 2011", "Median 2011", "Gini 2011", "P80/20 2011", "Top 10% Share 2011")
```

```{r Ungleichheitsindikatoren nach P1, include=FALSE}


#Definition Jahr; 
year <- 2012

#Erstellung des Survey Designs (in Zeile data=(silc.dprh %>% filter(pb010=XX) XX Für bestimmtes Jahr eintragen)
silc.dprh.svy <- svydesign(ids=~id_h,
                       strata=~db040,
                       weights=~db090,
                       data=(silc.dprh %>% filter(pb010==year))) %>% convey_prep()

# Mittelwert von Factor, National und Post Tax Disposable Income 
MeanIncomeP1 <- c(
  svymean(~factorincomep1,silc.dprh.svy),
  svymean(~nationalincomep1,silc.dprh.svy),
  svymean(~postaxincomep1,silc.dprh.svy))

# Median von Factor, National und Post Tax Disposable Income
MedianIncomeP1 <- c(
  svyquantile(~factorincomep1,silc.dprh.svy,quantile=c(0.5)),
  svyquantile(~nationalincomep1,silc.dprh.svy,quantile=c(0.5)),
  svyquantile(~postaxincomep1,silc.dprh.svy,quantile=c(0.5)))

# Gini von Factor, Natonal und Post Tax Disposable Income
GiniP1 <- c(
  svygini(~factorincomep1, silc.dprh.svy),
  svygini(~nationalincomep1, silc.dprh.svy),
  svygini(~postaxincomep1, silc.dprh.svy))

# P80/P20 von Factor, National und Post Tax Disposable Income
P8020P1 <- c(
  svyqsr(~factorincomep1,silc.dprh.svy),
  svyqsr(~nationalincomep1,silc.dprh.svy),
  svyqsr(~postaxincomep1,silc.dprh.svy))

# Top 10% Anteil von Factor, National und Post Tax Disposable Income

Top10ShareP1 <- c(
svytotal(~factorincomep1,subset(silc.dprh.svy, factorincomep1>=as.numeric(svyquantile(~factorincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~factorincomep1,silc.dprh.svy),
svytotal(~nationalincomep1,subset(silc.dprh.svy, nationalincomep1>=as.numeric(svyquantile(~nationalincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~nationalincomep1,silc.dprh.svy),
svytotal(~postaxincomep1,subset(silc.dprh.svy, postaxincomep1>=as.numeric(svyquantile(~postaxincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~postaxincomep1,silc.dprh.svy))

#Erstellung Tabelle
T2012P1 <- data.frame(MeanIncomeP1, MedianIncomeP1, GiniP1, P8020P1, Top10ShareP1)
colnames(T2012P1)<- c("Mean 2012", "Median 2012", "Gini 2012", "P80/20 2012", "Top 10% Share 2012")
```


```{r Ungleichheitsindikatoren nach P2, include=FALSE}
#Definition Jahr; 
year <- 2012

#Filtern >=20
silc.dprhp2 <- silc.dprh %>% filter(age >= 20)

#Erstellung des Survey Designs (in Zeile data=(silc.dprhp2 %>% filter(pb010=XX) XX Für bestimmtes Jahr eintragen)
silc.dprhp2.svy <- svydesign(ids=~id_h,
                       strata=~db040,
                       weights=~db090,
                       data=(silc.dprhp2 %>% filter(pb010==year))) %>% convey_prep()
# Mittelwert von Factor, National und Post Tax Disposable Income 
MeanIncomeP2 <- c(
  svymean(~factorincomep2,silc.dprhp2.svy),
  svymean(~nationalincomep2,silc.dprhp2.svy),
  svymean(~postaxincomep2,silc.dprhp2.svy))

# Median von Factor, National und Post Tax Disposable Income
MedianIncomeP2 <- c(
  svyquantile(~factorincomep2,silc.dprhp2.svy,quantile=c(0.5)),
  svyquantile(~nationalincomep2,silc.dprhp2.svy,quantile=c(0.5)),
  svyquantile(~postaxincomep2,silc.dprhp2.svy,quantile=c(0.5)))

# Gini von Factor, Natonal und Post Tax Disposable Income
GiniP2 <- c(
  svygini(~factorincomep2, silc.dprhp2.svy),
  svygini(~nationalincomep2, silc.dprhp2.svy),
  svygini(~postaxincomep2, silc.dprhp2.svy))

# P80/P20 von Factor, National und Post Tax Disposable Income
P8020P2 <- c(
  svyqsr(~factorincomep2,silc.dprhp2.svy),
  svyqsr(~nationalincomep2,silc.dprhp2.svy),
  svyqsr(~postaxincomep2,silc.dprhp2.svy))

# Top 10% Anteil von Factor, National und Post Tax Disposable Income

Top10ShareP2 <- c(
svytotal(~factorincomep2,subset(silc.dprhp2.svy, factorincomep2>=as.numeric(svyquantile(~factorincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~factorincomep2,silc.dprhp2.svy),
svytotal(~nationalincomep2,subset(silc.dprhp2.svy, nationalincomep2>=as.numeric(svyquantile(~nationalincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~nationalincomep2,silc.dprhp2.svy),
svytotal(~postaxincomep2,subset(silc.dprhp2.svy, postaxincomep2>=as.numeric(svyquantile(~postaxincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~postaxincomep2,silc.dprhp2.svy))

#Erstellung Tabelle
T2012P2 <- data.frame(MeanIncomeP2, MedianIncomeP2, GiniP2, P8020P2, Top10ShareP2)
colnames(T2012P2)<- c("Mean 2012", "Median 2012", "Gini 2012", "P80/20 2012", "Top 10% Share 2012")
```

```{r Ungleichheitsindikatoren nach P1, include=FALSE}


#Definition Jahr; 
year <- 2013

#Erstellung des Survey Designs (in Zeile data=(silc.dprh %>% filter(pb010=XX) XX Für bestimmtes Jahr eintragen)
silc.dprh.svy <- svydesign(ids=~id_h,
                       strata=~db040,
                       weights=~db090,
                       data=(silc.dprh %>% filter(pb010==year))) %>% convey_prep()

# Mittelwert von Factor, National und Post Tax Disposable Income 
MeanIncomeP1 <- c(
  svymean(~factorincomep1,silc.dprh.svy),
  svymean(~nationalincomep1,silc.dprh.svy),
  svymean(~postaxincomep1,silc.dprh.svy))

# Median von Factor, National und Post Tax Disposable Income
MedianIncomeP1 <- c(
  svyquantile(~factorincomep1,silc.dprh.svy,quantile=c(0.5)),
  svyquantile(~nationalincomep1,silc.dprh.svy,quantile=c(0.5)),
  svyquantile(~postaxincomep1,silc.dprh.svy,quantile=c(0.5)))

# Gini von Factor, Natonal und Post Tax Disposable Income
GiniP1 <- c(
  svygini(~factorincomep1, silc.dprh.svy),
  svygini(~nationalincomep1, silc.dprh.svy),
  svygini(~postaxincomep1, silc.dprh.svy))

# P80/P20 von Factor, National und Post Tax Disposable Income
P8020P1 <- c(
  svyqsr(~factorincomep1,silc.dprh.svy),
  svyqsr(~nationalincomep1,silc.dprh.svy),
  svyqsr(~postaxincomep1,silc.dprh.svy))

# Top 10% Anteil von Factor, National und Post Tax Disposable Income

Top10ShareP1 <- c(
svytotal(~factorincomep1,subset(silc.dprh.svy, factorincomep1>=as.numeric(svyquantile(~factorincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~factorincomep1,silc.dprh.svy),
svytotal(~nationalincomep1,subset(silc.dprh.svy, nationalincomep1>=as.numeric(svyquantile(~nationalincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~nationalincomep1,silc.dprh.svy),
svytotal(~postaxincomep1,subset(silc.dprh.svy, postaxincomep1>=as.numeric(svyquantile(~postaxincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~postaxincomep1,silc.dprh.svy))

#Erstellung Tabelle
T2013P1 <- data.frame(MeanIncomeP1, MedianIncomeP1, GiniP1, P8020P1, Top10ShareP1)
colnames(T2013P1)<- c("Mean 2013", "Median 2013", "Gini 2013", "P80/20 2013", "Top 10% Share 2013")
```


```{r Ungleichheitsindikatoren nach P2, include=FALSE}
#Definition Jahr; 
year <- 2013

#Filtern >=20
silc.dprhp2 <- silc.dprh %>% filter(age >= 20)

#Erstellung des Survey Designs (in Zeile data=(silc.dprhp2 %>% filter(pb010=XX) XX Für bestimmtes Jahr eintragen)
silc.dprhp2.svy <- svydesign(ids=~id_h,
                       strata=~db040,
                       weights=~db090,
                       data=(silc.dprhp2 %>% filter(pb010==year))) %>% convey_prep()
# Mittelwert von Factor, National und Post Tax Disposable Income 
MeanIncomeP2 <- c(
  svymean(~factorincomep2,silc.dprhp2.svy),
  svymean(~nationalincomep2,silc.dprhp2.svy),
  svymean(~postaxincomep2,silc.dprhp2.svy))

# Median von Factor, National und Post Tax Disposable Income
MedianIncomeP2 <- c(
  svyquantile(~factorincomep2,silc.dprhp2.svy,quantile=c(0.5)),
  svyquantile(~nationalincomep2,silc.dprhp2.svy,quantile=c(0.5)),
  svyquantile(~postaxincomep2,silc.dprhp2.svy,quantile=c(0.5)))

# Gini von Factor, Natonal und Post Tax Disposable Income
GiniP2 <- c(
  svygini(~factorincomep2, silc.dprhp2.svy),
  svygini(~nationalincomep2, silc.dprhp2.svy),
  svygini(~postaxincomep2, silc.dprhp2.svy))

# P80/P20 von Factor, National und Post Tax Disposable Income
P8020P2 <- c(
  svyqsr(~factorincomep2,silc.dprhp2.svy),
  svyqsr(~nationalincomep2,silc.dprhp2.svy),
  svyqsr(~postaxincomep2,silc.dprhp2.svy))

# Top 10% Anteil von Factor, National und Post Tax Disposable Income

Top10ShareP2 <- c(
svytotal(~factorincomep2,subset(silc.dprhp2.svy, factorincomep2>=as.numeric(svyquantile(~factorincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~factorincomep2,silc.dprhp2.svy),
svytotal(~nationalincomep2,subset(silc.dprhp2.svy, nationalincomep2>=as.numeric(svyquantile(~nationalincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~nationalincomep2,silc.dprhp2.svy),
svytotal(~postaxincomep2,subset(silc.dprhp2.svy, postaxincomep2>=as.numeric(svyquantile(~postaxincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~postaxincomep2,silc.dprhp2.svy))

#Erstellung Tabelle
T2013P2 <- data.frame(MeanIncomeP2, MedianIncomeP2, GiniP2, P8020P2, Top10ShareP2)
colnames(T2013P2)<- c("Mean 2013", "Median 2013", "Gini 2013", "P80/20 2013", "Top 10% Share 2013")
```

```{r Ungleichheitsindikatoren nach P1, include=FALSE}


#Definition Jahr; 
year <- 2014

#Erstellung des Survey Designs (in Zeile data=(silc.dprh %>% filter(pb010=XX) XX Für bestimmtes Jahr eintragen)
silc.dprh.svy <- svydesign(ids=~id_h,
                       strata=~db040,
                       weights=~db090,
                       data=(silc.dprh %>% filter(pb010==year))) %>% convey_prep()

# Mittelwert von Factor, National und Post Tax Disposable Income 
MeanIncomeP1 <- c(
  svymean(~factorincomep1,silc.dprh.svy),
  svymean(~nationalincomep1,silc.dprh.svy),
  svymean(~postaxincomep1,silc.dprh.svy))

# Median von Factor, National und Post Tax Disposable Income
MedianIncomeP1 <- c(
  svyquantile(~factorincomep1,silc.dprh.svy,quantile=c(0.5)),
  svyquantile(~nationalincomep1,silc.dprh.svy,quantile=c(0.5)),
  svyquantile(~postaxincomep1,silc.dprh.svy,quantile=c(0.5)))

# Gini von Factor, Natonal und Post Tax Disposable Income
GiniP1 <- c(
  svygini(~factorincomep1, silc.dprh.svy),
  svygini(~nationalincomep1, silc.dprh.svy),
  svygini(~postaxincomep1, silc.dprh.svy))

# P80/P20 von Factor, National und Post Tax Disposable Income
P8020P1 <- c(
  svyqsr(~factorincomep1,silc.dprh.svy),
  svyqsr(~nationalincomep1,silc.dprh.svy),
  svyqsr(~postaxincomep1,silc.dprh.svy))

# Top 10% Anteil von Factor, National und Post Tax Disposable Income

Top10ShareP1 <- c(
svytotal(~factorincomep1,subset(silc.dprh.svy, factorincomep1>=as.numeric(svyquantile(~factorincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~factorincomep1,silc.dprh.svy),
svytotal(~nationalincomep1,subset(silc.dprh.svy, nationalincomep1>=as.numeric(svyquantile(~nationalincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~nationalincomep1,silc.dprh.svy),
svytotal(~postaxincomep1,subset(silc.dprh.svy, postaxincomep1>=as.numeric(svyquantile(~postaxincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~postaxincomep1,silc.dprh.svy))

#Erstellung Tabelle
T2014P1 <- data.frame(MeanIncomeP1, MedianIncomeP1, GiniP1, P8020P1, Top10ShareP1)
colnames(T2014P1)<- c("Mean 2014", "Median 2014", "Gini 2014", "P80/20 2014", "Top 10% Share 2014")
```


```{r Ungleichheitsindikatoren nach P2, include=FALSE}
#Definition Jahr; 
year <- 2014

#Filtern >=20
silc.dprhp2 <- silc.dprh %>% filter(age >= 20)

#Erstellung des Survey Designs (in Zeile data=(silc.dprhp2 %>% filter(pb010=XX) XX Für bestimmtes Jahr eintragen)
silc.dprhp2.svy <- svydesign(ids=~id_h,
                       strata=~db040,
                       weights=~db090,
                       data=(silc.dprhp2 %>% filter(pb010==year))) %>% convey_prep()
# Mittelwert von Factor, National und Post Tax Disposable Income 
MeanIncomeP2 <- c(
  svymean(~factorincomep2,silc.dprhp2.svy),
  svymean(~nationalincomep2,silc.dprhp2.svy),
  svymean(~postaxincomep2,silc.dprhp2.svy))

# Median von Factor, National und Post Tax Disposable Income
MedianIncomeP2 <- c(
  svyquantile(~factorincomep2,silc.dprhp2.svy,quantile=c(0.5)),
  svyquantile(~nationalincomep2,silc.dprhp2.svy,quantile=c(0.5)),
  svyquantile(~postaxincomep2,silc.dprhp2.svy,quantile=c(0.5)))

# Gini von Factor, Natonal und Post Tax Disposable Income
GiniP2 <- c(
  svygini(~factorincomep2, silc.dprhp2.svy),
  svygini(~nationalincomep2, silc.dprhp2.svy),
  svygini(~postaxincomep2, silc.dprhp2.svy))

# P80/P20 von Factor, National und Post Tax Disposable Income
P8020P2 <- c(
  svyqsr(~factorincomep2,silc.dprhp2.svy),
  svyqsr(~nationalincomep2,silc.dprhp2.svy),
  svyqsr(~postaxincomep2,silc.dprhp2.svy))

# Top 10% Anteil von Factor, National und Post Tax Disposable Income

Top10ShareP2 <- c(
svytotal(~factorincomep2,subset(silc.dprhp2.svy, factorincomep2>=as.numeric(svyquantile(~factorincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~factorincomep2,silc.dprhp2.svy),
svytotal(~nationalincomep2,subset(silc.dprhp2.svy, nationalincomep2>=as.numeric(svyquantile(~nationalincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~nationalincomep2,silc.dprhp2.svy),
svytotal(~postaxincomep2,subset(silc.dprhp2.svy, postaxincomep2>=as.numeric(svyquantile(~postaxincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~postaxincomep2,silc.dprhp2.svy))

#Erstellung Tabelle
T2014P2 <- data.frame(MeanIncomeP2, MedianIncomeP2, GiniP2, P8020P2, Top10ShareP2)
colnames(T2014P2)<- c("Mean 2014", "Median 2014", "Gini 2014", "P80/20 2014", "Top 10% Share 2014")
```

```{r Ungleichheitsindikatoren nach P1, include=FALSE}


#Definition Jahr; 
year <- 2015

#Erstellung des Survey Designs (in Zeile data=(silc.dprh %>% filter(pb010=XX) XX Für bestimmtes Jahr eintragen)
silc.dprh.svy <- svydesign(ids=~id_h,
                       strata=~db040,
                       weights=~db090,
                       data=(silc.dprh %>% filter(pb010==year))) %>% convey_prep()

# Mittelwert von Factor, National und Post Tax Disposable Income 
MeanIncomeP1 <- c(
  svymean(~factorincomep1,silc.dprh.svy),
  svymean(~nationalincomep1,silc.dprh.svy),
  svymean(~postaxincomep1,silc.dprh.svy))

# Median von Factor, National und Post Tax Disposable Income
MedianIncomeP1 <- c(
  svyquantile(~factorincomep1,silc.dprh.svy,quantile=c(0.5)),
  svyquantile(~nationalincomep1,silc.dprh.svy,quantile=c(0.5)),
  svyquantile(~postaxincomep1,silc.dprh.svy,quantile=c(0.5)))

# Gini von Factor, Natonal und Post Tax Disposable Income
GiniP1 <- c(
  svygini(~factorincomep1, silc.dprh.svy),
  svygini(~nationalincomep1, silc.dprh.svy),
  svygini(~postaxincomep1, silc.dprh.svy))

# P80/P20 von Factor, National und Post Tax Disposable Income
P8020P1 <- c(
  svyqsr(~factorincomep1,silc.dprh.svy),
  svyqsr(~nationalincomep1,silc.dprh.svy),
  svyqsr(~postaxincomep1,silc.dprh.svy))

# Top 10% Anteil von Factor, National und Post Tax Disposable Income

Top10ShareP1 <- c(
svytotal(~factorincomep1,subset(silc.dprh.svy, factorincomep1>=as.numeric(svyquantile(~factorincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~factorincomep1,silc.dprh.svy),
svytotal(~nationalincomep1,subset(silc.dprh.svy, nationalincomep1>=as.numeric(svyquantile(~nationalincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~nationalincomep1,silc.dprh.svy),
svytotal(~postaxincomep1,subset(silc.dprh.svy, postaxincomep1>=as.numeric(svyquantile(~postaxincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~postaxincomep1,silc.dprh.svy))

#Erstellung Tabelle
T2015P1 <- data.frame(MeanIncomeP1, MedianIncomeP1, GiniP1, P8020P1, Top10ShareP1)
colnames(T2015P1)<- c("Mean 2015", "Median 2015", "Gini 2015", "P80/20 2015", "Top 10% Share 2015")
```


```{r Ungleichheitsindikatoren nach P2, include=FALSE}
#Definition Jahr; 
year <- 2015

#Filtern >=20
silc.dprhp2 <- silc.dprh %>% filter(age >= 20)

#Erstellung des Survey Designs (in Zeile data=(silc.dprhp2 %>% filter(pb010=XX) XX Für bestimmtes Jahr eintragen)
silc.dprhp2.svy <- svydesign(ids=~id_h,
                       strata=~db040,
                       weights=~db090,
                       data=(silc.dprhp2 %>% filter(pb010==year))) %>% convey_prep()
# Mittelwert von Factor, National und Post Tax Disposable Income 
MeanIncomeP2 <- c(
  svymean(~factorincomep2,silc.dprhp2.svy),
  svymean(~nationalincomep2,silc.dprhp2.svy),
  svymean(~postaxincomep2,silc.dprhp2.svy))

# Median von Factor, National und Post Tax Disposable Income
MedianIncomeP2 <- c(
  svyquantile(~factorincomep2,silc.dprhp2.svy,quantile=c(0.5)),
  svyquantile(~nationalincomep2,silc.dprhp2.svy,quantile=c(0.5)),
  svyquantile(~postaxincomep2,silc.dprhp2.svy,quantile=c(0.5)))

# Gini von Factor, Natonal und Post Tax Disposable Income
GiniP2 <- c(
  svygini(~factorincomep2, silc.dprhp2.svy),
  svygini(~nationalincomep2, silc.dprhp2.svy),
  svygini(~postaxincomep2, silc.dprhp2.svy))

# P80/P20 von Factor, National und Post Tax Disposable Income
P8020P2 <- c(
  svyqsr(~factorincomep2,silc.dprhp2.svy),
  svyqsr(~nationalincomep2,silc.dprhp2.svy),
  svyqsr(~postaxincomep2,silc.dprhp2.svy))

# Top 10% Anteil von Factor, National und Post Tax Disposable Income

Top10ShareP2 <- c(
svytotal(~factorincomep2,subset(silc.dprhp2.svy, factorincomep2>=as.numeric(svyquantile(~factorincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~factorincomep2,silc.dprhp2.svy),
svytotal(~nationalincomep2,subset(silc.dprhp2.svy, nationalincomep2>=as.numeric(svyquantile(~nationalincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~nationalincomep2,silc.dprhp2.svy),
svytotal(~postaxincomep2,subset(silc.dprhp2.svy, postaxincomep2>=as.numeric(svyquantile(~postaxincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~postaxincomep2,silc.dprhp2.svy))

#Erstellung Tabelle
T2015P2 <- data.frame(MeanIncomeP2, MedianIncomeP2, GiniP2, P8020P2, Top10ShareP2)
colnames(T2015P2)<- c("Mean 2015", "Median 2015", "Gini 2015", "P80/20 2015", "Top 10% Share 2015")
```

```{r Ungleichheitsindikatoren nach P1, include=FALSE}


#Definition Jahr; 
year <- 2016

#Erstellung des Survey Designs (in Zeile data=(silc.dprh %>% filter(pb010=XX) XX Für bestimmtes Jahr eintragen)
silc.dprh.svy <- svydesign(ids=~id_h,
                       strata=~db040,
                       weights=~db090,
                       data=(silc.dprh %>% filter(pb010==year))) %>% convey_prep()

# Mittelwert von Factor, National und Post Tax Disposable Income 
MeanIncomeP1 <- c(
  svymean(~factorincomep1,silc.dprh.svy),
  svymean(~nationalincomep1,silc.dprh.svy),
  svymean(~postaxincomep1,silc.dprh.svy))

# Median von Factor, National und Post Tax Disposable Income
MedianIncomeP1 <- c(
  svyquantile(~factorincomep1,silc.dprh.svy,quantile=c(0.5)),
  svyquantile(~nationalincomep1,silc.dprh.svy,quantile=c(0.5)),
  svyquantile(~postaxincomep1,silc.dprh.svy,quantile=c(0.5)))

# Gini von Factor, Natonal und Post Tax Disposable Income
GiniP1 <- c(
  svygini(~factorincomep1, silc.dprh.svy),
  svygini(~nationalincomep1, silc.dprh.svy),
  svygini(~postaxincomep1, silc.dprh.svy))

# P80/P20 von Factor, National und Post Tax Disposable Income
P8020P1 <- c(
  svyqsr(~factorincomep1,silc.dprh.svy),
  svyqsr(~nationalincomep1,silc.dprh.svy),
  svyqsr(~postaxincomep1,silc.dprh.svy))

# Top 10% Anteil von Factor, National und Post Tax Disposable Income

Top10ShareP1 <- c(
svytotal(~factorincomep1,subset(silc.dprh.svy, factorincomep1>=as.numeric(svyquantile(~factorincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~factorincomep1,silc.dprh.svy),
svytotal(~nationalincomep1,subset(silc.dprh.svy, nationalincomep1>=as.numeric(svyquantile(~nationalincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~nationalincomep1,silc.dprh.svy),
svytotal(~postaxincomep1,subset(silc.dprh.svy, postaxincomep1>=as.numeric(svyquantile(~postaxincomep1,silc.dprh.svy,quantile=c(0.9)))))/svytotal(~postaxincomep1,silc.dprh.svy))

#Erstellung Tabelle
T2016P1 <- data.frame(MeanIncomeP1, MedianIncomeP1, GiniP1, P8020P1, Top10ShareP1)
colnames(T2016P1)<- c("Mean 2016", "Median 2016", "Gini 2016", "P80/20 2016", "Top 10% Share 2016")
```


```{r Ungleichheitsindikatoren nach P2, include=FALSE}
#Definition Jahr; 
year <- 2016

#Filtern >=20
silc.dprhp2 <- silc.dprh %>% filter(age >= 20)

#Erstellung des Survey Designs (in Zeile data=(silc.dprhp2 %>% filter(pb010=XX) XX Für bestimmtes Jahr eintragen)
silc.dprhp2.svy <- svydesign(ids=~id_h,
                       strata=~db040,
                       weights=~db090,
                       data=(silc.dprhp2 %>% filter(pb010==year))) %>% convey_prep()
# Mittelwert von Factor, National und Post Tax Disposable Income 
MeanIncomeP2 <- c(
  svymean(~factorincomep2,silc.dprhp2.svy),
  svymean(~nationalincomep2,silc.dprhp2.svy),
  svymean(~postaxincomep2,silc.dprhp2.svy))

# Median von Factor, National und Post Tax Disposable Income
MedianIncomeP2 <- c(
  svyquantile(~factorincomep2,silc.dprhp2.svy,quantile=c(0.5)),
  svyquantile(~nationalincomep2,silc.dprhp2.svy,quantile=c(0.5)),
  svyquantile(~postaxincomep2,silc.dprhp2.svy,quantile=c(0.5)))

# Gini von Factor, Natonal und Post Tax Disposable Income
GiniP2 <- c(
  svygini(~factorincomep2, silc.dprhp2.svy),
  svygini(~nationalincomep2, silc.dprhp2.svy),
  svygini(~postaxincomep2, silc.dprhp2.svy))

# P80/P20 von Factor, National und Post Tax Disposable Income
P8020P2 <- c(
  svyqsr(~factorincomep2,silc.dprhp2.svy),
  svyqsr(~nationalincomep2,silc.dprhp2.svy),
  svyqsr(~postaxincomep2,silc.dprhp2.svy))

# Top 10% Anteil von Factor, National und Post Tax Disposable Income

Top10ShareP2 <- c(
svytotal(~factorincomep2,subset(silc.dprhp2.svy, factorincomep2>=as.numeric(svyquantile(~factorincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~factorincomep2,silc.dprhp2.svy),
svytotal(~nationalincomep2,subset(silc.dprhp2.svy, nationalincomep2>=as.numeric(svyquantile(~nationalincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~nationalincomep2,silc.dprhp2.svy),
svytotal(~postaxincomep2,subset(silc.dprhp2.svy, postaxincomep2>=as.numeric(svyquantile(~postaxincomep2,silc.dprhp2.svy,quantile=c(0.9)))))/svytotal(~postaxincomep2,silc.dprhp2.svy))

#Erstellung Tabelle
T2016P2 <- data.frame(MeanIncomeP2, MedianIncomeP2, GiniP2, P8020P2, Top10ShareP2)
colnames(T2016P2)<- c("Mean 2016", "Median 2016", "Gini 2016", "P80/20 2016", "Top 10% Share 2016")
```



```{r Tabellen P1, include=FALSE}
MeanP1T <- data.frame(T2008P1$`Mean 2008`, T2009P1$`Mean 2009`, T2010P1$`Mean 2010`, T2011P1$`Mean 2011`, T2012P1$`Mean 2012`, T2013P1$`Mean 2013`, T2014P1$`Mean 2014`, T2015P1$`Mean 2015`, T2016P1$`Mean 2016`)
colnames(MeanP1T) <- c(2008:2016)
rownames(MeanP1T) <- c("Vorsteuer Faktoreinkommen", "Vorsteuer Nationaleinkommen", "Nachsteuer Verfügbares Einkommen")

MedianP1T <- data.frame(T2008P1$`Median 2008`, T2009P1$`Median 2009`, T2010P1$`Median 2010`, T2011P1$`Median 2011`, T2012P1$`Median 2012`, T2013P1$`Median 2013`, T2014P1$`Median 2014`, T2015P1$`Median 2015`, T2016P1$`Median 2016`)
colnames(MedianP1T) <- c(2008:2016)
rownames(MedianP1T) <- c("Vorsteuer Faktoreinkommen", "Vorsteuer Nationaleinkommen", "Nachsteuer Verfügbares Einkommen")

GiniP1T <- data.frame(T2008P1$`Gini 2008`, T2009P1$`Gini 2009`, T2010P1$`Gini 2010`, T2011P1$`Gini 2011`, T2012P1$`Gini 2012`, T2013P1$`Gini 2013`, T2014P1$`Gini 2014`, T2015P1$`Gini 2015`, T2016P1$`Gini 2016`)
colnames(GiniP1T) <- c(2008:2016)
rownames(GiniP1T) <- c("Vorsteuer Faktoreinkommen", "Vorsteuer Nationaleinkommen", "Nachsteuer Verfügbares Einkommen")

P8020P1T <- data.frame(T2008P1$`P80/20 2008`, T2009P1$`P80/20 2009`, T2010P1$`P80/20 2010`, T2011P1$`P80/20 2011`, T2012P1$`P80/20 2012`, T2013P1$`P80/20 2013`, T2014P1$`P80/20 2014`, T2015P1$`P80/20 2015`, T2016P1$`P80/20 2016`)
colnames(P8020P1T) <- c(2008:2016)
rownames(P8020P1T) <- c("Vorsteuer Faktoreinkommen", "Vorsteuer Nationaleinkommen", "Nachsteuer Verfügbares Einkommen")

T10SP1T <- data.frame(T2008P1$`Top 10% Share 2008`, T2009P1$`Top 10% Share 2009`, T2010P1$`Top 10% Share 2010`, T2011P1$`Top 10% Share 2011`, T2012P1$`Top 10% Share 2012`, T2013P1$`Top 10% Share 2013`, T2014P1$`Top 10% Share 2014`, T2015P1$`Top 10% Share 2015`, T2016P1$`Top 10% Share 2016`)
colnames(T10SP1T) <- c(2008:2016)
rownames(T10SP1T) <- c("Vorsteuer Faktoreinkommen", "Vorsteuer Nationaleinkommen", "Nachsteuer Verfügbares Einkommen")

```

```{r Mean Tabelle P2, include=FALSE}
MeanP2T <- data.frame(T2008P2$`Mean 2008`, T2009P2$`Mean 2009`, T2010P2$`Mean 2010`, T2011P2$`Mean 2011`, T2012P2$`Mean 2012`, T2013P2$`Mean 2013`, T2014P2$`Mean 2014`, T2015P2$`Mean 2015`, T2016P2$`Mean 2016`)
colnames(MeanP2T) <- c(2008:2016)
rownames(MeanP2T) <- c("Vorsteuer Faktoreinkommen", "Vorsteuer Nationaleinkommen", "Nachsteuer Verfügbares Einkommen")

MedianP2T <- data.frame(T2008P2$`Median 2008`, T2009P2$`Median 2009`, T2010P2$`Median 2010`, T2011P2$`Median 2011`, T2012P2$`Median 2012`, T2013P2$`Median 2013`, T2014P2$`Median 2014`, T2015P2$`Median 2015`, T2016P2$`Median 2016`)
colnames(MedianP2T) <- c(2008:2016)
rownames(MedianP2T) <- c("Vorsteuer Faktoreinkommen", "Vorsteuer Nationaleinkommen", "Nachsteuer Verfügbares Einkommen")

GiniP2T <- data.frame(T2008P2$`Gini 2008`, T2009P2$`Gini 2009`, T2010P2$`Gini 2010`, T2011P2$`Gini 2011`, T2012P2$`Gini 2012`, T2013P2$`Gini 2013`, T2014P2$`Gini 2014`, T2015P2$`Gini 2015`, T2016P2$`Gini 2016`)
colnames(GiniP2T) <- c(2008:2016)
rownames(GiniP2T) <- c("Vorsteuer Faktoreinkommen", "Vorsteuer Nationaleinkommen", "Nachsteuer Verfügbares Einkommen")

P8020P2T <- data.frame(T2008P2$`P80/20 2008`, T2009P2$`P80/20 2009`, T2010P2$`P80/20 2010`, T2011P2$`P80/20 2011`, T2012P2$`P80/20 2012`, T2013P2$`P80/20 2013`, T2014P2$`P80/20 2014`, T2015P2$`P80/20 2015`, T2016P2$`P80/20 2016`)
colnames(P8020P2T) <- c(2008:2016)
rownames(P8020P2T) <- c("Vorsteuer Faktoreinkommen", "Vorsteuer Nationaleinkommen", "Nachsteuer Verfügbares Einkommen")

T10SP2T <- data.frame(T2008P2$`Top 10% Share 2008`, T2009P2$`Top 10% Share 2009`, T2010P2$`Top 10% Share 2010`, T2011P2$`Top 10% Share 2011`, T2012P2$`Top 10% Share 2012`, T2013P2$`Top 10% Share 2013`, T2014P2$`Top 10% Share 2014`, T2015P2$`Top 10% Share 2015`, T2016P2$`Top 10% Share 2016`)
colnames(T10SP2T) <- c(2008:2016)
rownames(T10SP2T) <- c("Vorsteuer Faktoreinkommen", "Vorsteuer Nationaleinkommen", "Nachsteuer Verfügbares Einkommen")
```


























